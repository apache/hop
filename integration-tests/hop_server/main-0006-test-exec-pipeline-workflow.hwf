<?xml version="1.0" encoding="UTF-8"?>
<!--

Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

-->
<workflow>
  <name>main-0006-test-exec-pipeline-workflow</name>
  <name_sync_with_filename>Y</name_sync_with_filename>
  <description>Integration tests for execPipeline and execWorkflow servlets using samples project</description>
  <extended_description/>
  <workflow_version/>
  <created_user>-</created_user>
  <created_date>2024/01/01 00:00:00.000</created_date>
  <modified_user>-</modified_user>
  <modified_date>2024/01/01 00:00:00.000</modified_date>
  <parameters>
    </parameters>
  <actions>
    <action>
      <name>Start</name>
      <description/>
      <type>SPECIAL</type>
      <attributes/>
      <DayOfMonth>1</DayOfMonth>
      <doNotWaitOnFirstExecution>N</doNotWaitOnFirstExecution>
      <hour>12</hour>
      <intervalMinutes>60</intervalMinutes>
      <intervalSeconds>0</intervalSeconds>
      <minutes>0</minutes>
      <repeat>N</repeat>
      <schedulerType>0</schedulerType>
      <weekDay>1</weekDay>
      <parallel>N</parallel>
      <xloc>50</xloc>
      <yloc>50</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Test 1: ExecPipeline with absolute path to samples</name>
      <description>Test execPipeline servlet with absolute file path to samples pipeline</description>
      <type>SHELL</type>
      <attributes/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <arg_from_previous>N</arg_from_previous>
      <arguments>
</arguments>
      <exec_per_row>N</exec_per_row>
      <insertScript>Y</insertScript>
      <loglevel>Basic</loglevel>
      <script>curl -u cluster:cluster --fail -L -s "http://hop-server:8181/hop/execPipeline?pipeline=/opt/hop/config/projects/samples/pipelines/pipeline-with-parameter.hpl&amp;PRM_EXAMPLE=test_value&amp;level=BASIC" | grep -q "&lt;result>OK&lt;/result>" || exit 1</script>
      <set_append_logfile>N</set_append_logfile>
      <set_logfile>N</set_logfile>
      <parallel>N</parallel>
      <xloc>192</xloc>
      <yloc>50</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Test 2: ExecPipeline with PROJECT_HOME path to samples</name>
      <description>Test execPipeline servlet with ${PROJECT_HOME} variable in path to samples</description>
      <type>SHELL</type>
      <attributes/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <arg_from_previous>N</arg_from_previous>
      <arguments>
</arguments>
      <exec_per_row>N</exec_per_row>
      <insertScript>Y</insertScript>
      <loglevel>Basic</loglevel>
      <script>curl -u cluster:cluster --fail -L -s "http://hop-server:8181/hop/execPipeline?pipeline=%24%7BPROJECT_HOME%7D/pipelines/pipeline-with-parameter.hpl&amp;PRM_EXAMPLE=test_from_var&amp;level=BASIC" | grep -q "&lt;result>OK&lt;/result>" || exit 1</script>
      <set_append_logfile>N</set_append_logfile>
      <set_logfile>N</set_logfile>
      <parallel>N</parallel>
      <xloc>192</xloc>
      <yloc>128</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Test 3: ExecPipeline with absolute path to read-transactions</name>
      <description>Test execPipeline servlet with absolute path to read-transactions sample</description>
      <type>SHELL</type>
      <attributes/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <arg_from_previous>N</arg_from_previous>
      <arguments>
</arguments>
      <exec_per_row>N</exec_per_row>
      <insertScript>Y</insertScript>
      <loglevel>Basic</loglevel>
      <script>curl -u cluster:cluster --fail -L -s "http://hop-server:8181/hop/execPipeline?pipeline=/opt/hop/config/projects/samples/pipelines/read-transactions.hpl&amp;level=BASIC" | grep -q "&lt;result>OK&lt;/result>" || exit 1</script>
      <set_append_logfile>N</set_append_logfile>
      <set_logfile>N</set_logfile>
      <parallel>N</parallel>
      <xloc>192</xloc>
      <yloc>208</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Test 4: ExecWorkflow with absolute path to samples</name>
      <description>Test execWorkflow servlet with absolute file path to samples workflow</description>
      <type>SHELL</type>
      <attributes/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <arg_from_previous>N</arg_from_previous>
      <arguments>
</arguments>
      <exec_per_row>N</exec_per_row>
      <insertScript>Y</insertScript>
      <loglevel>Basic</loglevel>
      <script>curl -u cluster:cluster --fail -L -s "http://hop-server:8181/hop/execWorkflow?workflow=/opt/hop/config/projects/samples/workflows/parallel/parallel-workflow.hwf&amp;level=BASIC" | grep -q "&lt;result>OK&lt;/result>" || exit 1</script>
      <set_append_logfile>N</set_append_logfile>
      <set_logfile>N</set_logfile>
      <parallel>N</parallel>
      <xloc>192</xloc>
      <yloc>288</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Test 5: ExecWorkflow with PROJECT_HOME path to samples</name>
      <description>Test execWorkflow servlet with ${PROJECT_HOME} variable in path to samples</description>
      <type>SHELL</type>
      <attributes/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <arg_from_previous>N</arg_from_previous>
      <arguments>
</arguments>
      <exec_per_row>N</exec_per_row>
      <insertScript>Y</insertScript>
      <loglevel>Basic</loglevel>
      <script>curl -u cluster:cluster --fail -L -s "http://hop-server:8181/hop/execWorkflow?workflow=%24%7BPROJECT_HOME%7D/workflows/parallel/parallel-workflow.hwf&amp;level=BASIC" | grep -q "&lt;result>OK&lt;/result>" || exit 1</script>
      <set_append_logfile>N</set_append_logfile>
      <set_logfile>N</set_logfile>
      <parallel>N</parallel>
      <xloc>192</xloc>
      <yloc>368</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Test 6: ExecPipeline error - missing parameter</name>
      <description>Test execPipeline servlet error handling - missing pipeline parameter</description>
      <type>SHELL</type>
      <attributes/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <arg_from_previous>N</arg_from_previous>
      <arguments>
</arguments>
      <exec_per_row>N</exec_per_row>
      <insertScript>Y</insertScript>
      <loglevel>Basic</loglevel>
      <script>curl -u cluster:cluster -L -s -w "%{http_code}" "http://hop-server:8181/hop/execPipeline?level=BASIC" | grep -q "400" || exit 1</script>
      <set_append_logfile>N</set_append_logfile>
      <set_logfile>N</set_logfile>
      <parallel>N</parallel>
      <xloc>192</xloc>
      <yloc>448</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Test 8: ExecPipeline error - file not found</name>
      <description>Test execPipeline servlet error handling - file not found</description>
      <type>SHELL</type>
      <attributes/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <arg_from_previous>N</arg_from_previous>
      <arguments>
</arguments>
      <exec_per_row>N</exec_per_row>
      <filename/>
      <insertScript>Y</insertScript>
      <logext/>
      <logfile/>
      <loglevel>Basic</loglevel>
      <script>curl -u cluster:cluster -L -s -w "%{http_code}" "http://hop-server:8181/hop/execPipeline?pipeline=/opt/hop/config/projects/samples/pipelines/nonexistent-pipeline.hpl" | grep -q "404" || exit 1</script>
      <set_append_logfile>N</set_append_logfile>
      <set_logfile>N</set_logfile>
      <work_directory/>
      <parallel>N</parallel>
      <xloc>192</xloc>
      <yloc>608</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Test 7: ExecWorkflow error - missing parameter</name>
      <description>Test execWorkflow servlet error handling - missing workflow parameter</description>
      <type>SHELL</type>
      <attributes/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <arg_from_previous>N</arg_from_previous>
      <arguments>
</arguments>
      <exec_per_row>N</exec_per_row>
      <filename/>
      <insertScript>Y</insertScript>
      <logext/>
      <logfile/>
      <loglevel>Basic</loglevel>
      <script>curl -u cluster:cluster -L -s -w "%{http_code}" "http://hop-server:8181/hop/execWorkflow?level=BASIC" | grep -q "400" || exit 1</script>
      <set_append_logfile>N</set_append_logfile>
      <set_logfile>N</set_logfile>
      <work_directory/>
      <parallel>N</parallel>
      <xloc>192</xloc>
      <yloc>528</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Test 9: ExecWorkflow error - file not found</name>
      <description>Test execWorkflow servlet error handling - file not found</description>
      <type>SHELL</type>
      <attributes/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <arg_from_previous>N</arg_from_previous>
      <arguments>
</arguments>
      <exec_per_row>N</exec_per_row>
      <insertScript>Y</insertScript>
      <loglevel>Basic</loglevel>
      <script>curl -u cluster:cluster -L -s -w "%{http_code}" "http://hop-server:8181/hop/execWorkflow?workflow=/opt/hop/config/projects/samples/workflows/nonexistent-workflow.hwf" | grep -q "404" || exit 1</script>
      <set_append_logfile>N</set_append_logfile>
      <set_logfile>N</set_logfile>
      <parallel>N</parallel>
      <xloc>192</xloc>
      <yloc>688</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Abort workflow</name>
      <description/>
      <type>ABORT</type>
      <attributes/>
      <always_log_rows>N</always_log_rows>
      <parallel>N</parallel>
      <xloc>560</xloc>
      <yloc>432</yloc>
      <attributes_hac/>
    </action>
    <action>
      <name>Success</name>
      <description/>
      <type>SUCCESS</type>
      <attributes/>
      <parallel>N</parallel>
      <xloc>192</xloc>
      <yloc>784</yloc>
      <attributes_hac/>
    </action>
  </actions>
  <hops>
    <hop>
      <from>Start</from>
      <to>Test 1: ExecPipeline with absolute path to samples</to>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>Test 1: ExecPipeline with absolute path to samples</from>
      <to>Test 2: ExecPipeline with PROJECT_HOME path to samples</to>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 2: ExecPipeline with PROJECT_HOME path to samples</from>
      <to>Test 3: ExecPipeline with absolute path to read-transactions</to>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 3: ExecPipeline with absolute path to read-transactions</from>
      <to>Test 4: ExecWorkflow with absolute path to samples</to>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 4: ExecWorkflow with absolute path to samples</from>
      <to>Test 5: ExecWorkflow with PROJECT_HOME path to samples</to>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 5: ExecWorkflow with PROJECT_HOME path to samples</from>
      <to>Test 6: ExecPipeline error - missing parameter</to>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 1: ExecPipeline with absolute path to samples</from>
      <to>Abort workflow</to>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 2: ExecPipeline with PROJECT_HOME path to samples</from>
      <to>Abort workflow</to>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 3: ExecPipeline with absolute path to read-transactions</from>
      <to>Abort workflow</to>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 4: ExecWorkflow with absolute path to samples</from>
      <to>Abort workflow</to>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 5: ExecWorkflow with PROJECT_HOME path to samples</from>
      <to>Abort workflow</to>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 6: ExecPipeline error - missing parameter</from>
      <to>Abort workflow</to>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 8: ExecPipeline error - file not found</from>
      <to>Abort workflow</to>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 9: ExecWorkflow error - file not found</from>
      <to>Abort workflow</to>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 9: ExecWorkflow error - file not found</from>
      <to>Success</to>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 8: ExecPipeline error - file not found</from>
      <to>Test 9: ExecWorkflow error - file not found</to>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 6: ExecPipeline error - missing parameter</from>
      <to>Test 7: ExecWorkflow error - missing parameter</to>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Test 7: ExecWorkflow error - missing parameter</from>
      <to>Test 8: ExecPipeline error - file not found</to>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
  <attributes/>
</workflow>
